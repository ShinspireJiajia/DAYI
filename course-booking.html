<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>èª²ç¨‹æ´»å‹• - æ™ºç”Ÿæ´»</title>
  <link rel="icon" href="data:," />
  <link rel="stylesheet" href="styles.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
  <style>
    .filter-card { background:#fff; border:1px solid #e5e7eb; border-radius:16px; padding:12px; box-shadow:0 2px 8px rgba(0,0,0,0.06); margin-bottom:16px; }
    .filter-grid { display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
    .filter-field { display:flex; flex-direction:column; gap:6px; }
    .filter-field label { font-size:12px; color:#374151; font-weight:700; }
    .filter-field select, .filter-field input[type=date], .filter-field input[type=time] { border:1px solid #e5e7eb; border-radius:10px; padding:10px; font-size:14px; background:#fff; color:#111827; }
    .filter-actions { display:flex; gap:10px; margin-top:8px; }
    .btn { border:none; border-radius:10px; padding:10px 12px; font-size:14px; cursor:pointer; }
    .btn-primary { background:#111827; color:#fff;font-size:16px;}
    .btn-ghost {font-size:16px; padding:8px 16px; display:flex; align-items:center; gap:8px;background:#fff !important;border:1px solid #00b4b4 !important;color:#00b4b4 !important;border-radius:20px !important;display: block;text-align: center;}
    .btn-ghost-2 {font-size:16px; padding:8px 16px; display:flex; align-items:center; gap:8px;background:#fff !important;border:1px solid #ccc !important;color:#666 !important;border-radius:8px !important;display: block;text-align: center;}
    .course-list { display:grid; gap:0; } /* Remove gap for zebra striping to look connected or keep gap? User said zebra striping for cards. Usually cards have gaps. Let's keep gap but change background. */
    .course-card { 
      border-radius:12px; 
      padding:16px; /* Increased padding */
      display:flex; box-shadow: 0 1px 4px rgba(0, 180, 180, 0.08);
      flex-direction: column;
      gap:12px; 
      min-height:120px; 
      margin-bottom: 12px; /* Add margin bottom for gap */
    }
    /* Zebra Striping */
    .course-card:nth-child(odd) { background-color: #FFFFFF; }
    .course-card:nth-child(even) { background-color: #ffffff; }


    
    .course-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 12px;
      width: 100%;
    }

    .course-title-group {
      display: flex;
      align-items: center;align-items: center;
      gap: 12px;
      flex: 1;
    }

    /* Course Name: Bold and Largest */
    .course-title { 
      font-weight:600; 
      color:#000; 
      font-size:18px; /* Increased size */
      letter-spacing:0.5px; 
      line-height: 1.2;
    }
    .course-name { cursor:pointer; text-decoration:none; color:#000; }
    .course-name:hover { color:#194f5b; text-decoration:none; }
    



    /* Points: Smaller or right corner */
    .course-points {
      font-size: 18px;
      color: #194f5b;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding:4px 12px 4px 0;
      border-radius:8px;
      font-weight: 600;
    }
    .course-points img{width:20px;}
    .view-details-link {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        color: #eb2571;
        font-size: 14px;
        font-weight: 600;
        text-decoration: none;
        margin-top: 8px;
    }
    .view-details-link:hover {
        text-decoration: underline;
    }

    .course-sub { font-size:15px; color:#6b7280; margin:4px 0; letter-spacing:0.3px; } /* Keep for backward compatibility if needed */
    
    .badge { font-size:14px; padding:6px 10px; border-radius:999px; font-weight:700; }
    .badge-type { background:#e8f5e8; color:#2e7d32; align-self: flex-start; }
    .status-available { background:#e8f5e8; color:#2e7d32; }
    .status-full { background:#ffebee; color:#c62828; }
    
    /* Buttons: Increased size by 15% */
    .btn-book, .btn-waitlist, .btn-disabled { 
      border:none; 
      padding:8px 16px; /* Adjusted padding */
      border-radius:8px; 
      font-size:16px; /* Adjusted font size */
      cursor:pointer; 
      font-weight: 600;
      min-width: 80px;
      text-align: center;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .btn-book { background:#00b4b4; color:#fff; }
    .btn-book:hover { background:#00b4b4; transform: scale(1.02); }
    
    .btn-waitlist { background:#194f5b; color:#fff; }
    
    /* Disabled Button */
    .btn-disabled { 
      background: #e5e7eb; 
      color: #9ca3af; 
      cursor: not-allowed; 
      pointer-events: none;
    }

    
    
    /* Custom Popup Styles */
    .popup-overlay {
        position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5); z-index: 2000;
        display: none; justify-content: center; align-items: center;
        backdrop-filter: blur(4px);
    }
    .popup-container {
        background: white; width: 85%; max-width: 320px;
        border-radius: 16px; padding: 24px; text-align: center;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
    .popup-icon { font-size: 48px; margin-bottom: 16px; color: #00b0ff; }
    .popup-title { font-size: 18px; font-weight: 700; color: #111827; margin-bottom: 8px; }
    .popup-message { font-size: 14px; color: #47727c; margin-bottom: 24px; line-height: 1.5; white-space: pre-line; }
    .popup-actions { display: flex; gap: 12px; justify-content: center; }
    .popup-actions button { flex: 1; padding: 12px; border-radius: 10px; border: none; font-size: 15px; font-weight: 600; cursor: pointer; }
    .btn-confirm { background: #00b0ff; color: white; }
    .btn-cancel { background: #f3f4f6; color: #374151; }
  </style>
  <script>
    const COURSES = [
      { 
        id:'C999', 
        name:'å€™è£œé«”é©—èª²ç¨‹', 
        category: 'é«”é©—æ´»å‹•',
        tags: ['é«”é©—', 'æ´»å‹•'], 
        day:'2025/12/19', 
        time:'14:00-16:00', 
        site:'Aæ£§1F å¤§å»³', 
        maxSeats: 10,
        availableSeats: 0, 
        points: 100,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'æ­¤èª²ç¨‹ç”¨æ–¼æ¨¡æ“¬å€™è£œæµç¨‹',
        description: 'é€™æ˜¯ä¸€å€‹æ¸¬è©¦èª²ç¨‹ï¼Œåé¡å·²æ»¿ï¼Œè«‹é»æ“Šå€™è£œæŒ‰éˆ•é€²è¡Œé«”é©—ã€‚',
        instructor: 'æ¸¬è©¦äººå“¡',
        materials: 'ç„¡',
        registrationDeadline: '2025/12/19',
        image: 'https://placehold.co/600x400?text=Waitlist+Test'
      },
      { 
        id:'C101', 
        name:'æ¨‚é½¡è‚ŒåŠ›è¨“ç·´', 
        category: 'é‹å‹•å¥åº·',
        tags: ['æˆ¶å¤–', 'è‚ŒåŠ›'], 
        day:'2026/5/15', 
        time:'10:00-11:00', 
        site:'Aæ£§3F å¤šåŠŸèƒ½å®¤', 
        maxSeats: 12,
        availableSeats: 4, 
        points: 500,
        sessions: 8,
        fee: 'æ‰£é»',
        note:'è¼•é‡å•éˆ´ã€å½ˆåŠ›å¸¶ï¼Œæå‡è‚Œè€åŠ›',
        description: '<strong>ğŸŒŸ æ¨‚é½¡è‚ŒåŠ›è¨“ç·´ï¼šé‡æ‹¾æ´»åŠ›èˆ‡å¹³è¡¡</strong><br><br><strong>èª²ç¨‹ç°¡ä»‹ï¼š</strong> éš¨è‘—å¹´é½¡å¢é•·ï¼Œè‚Œè‚‰åŠ›é‡æœƒé€æ¼¸æµå¤±ï¼Œé€²è€Œå½±éŸ¿ç”Ÿæ´»å“è³ªã€‚æœ¬å¥—ã€Œæ¨‚é½¡è‚ŒåŠ›è¨“ç·´ã€èª²ç¨‹ç”±è³‡æ·±ç‰©ç†æ²»ç™‚å¸«/å°ˆæ¥­æ•™ç·´è¨­è¨ˆï¼Œæ¡ç”¨æº«å’Œä¸”æœ‰æ•ˆçš„è¨“ç·´æ–¹æ³•ï¼Œå¹«åŠ© 50 æ­²ä»¥ä¸Šçš„å­¸å“¡å®‰å…¨åœ°é€²è¡ŒåŠ›é‡è¨“ç·´ã€‚èª²ç¨‹ä¸­å°‡æœƒåˆ©ç”¨è¼•é‡å™¨ææˆ–è‡ªèº«é‡é‡ï¼Œå°ˆæ³¨æ–¼æå‡å¤§è‚Œç¾¤åŠ›é‡ã€æ”¹å–„é—œç¯€æ´»å‹•åº¦åŠå¢é€²èº«é«”å¹³è¡¡æ„Ÿã€‚<br><br><strong>èª°é©åˆåƒåŠ ï¼Ÿ</strong><ul><li>å¸Œæœ›æ”¹å–„èµ°è·¯å§¿å‹¢ã€é˜²æ­¢é§èƒŒè€…ã€‚</li><li>æ“”å¿ƒè·Œå€’ã€å¸Œæœ›æå‡èº«é«”ç©©å®šæ€§è€…ã€‚</li><li>å¸Œæœ›ä¿æŒæ´»åŠ›ã€äº«å—æ›´é«˜å“è³ªé€€ä¼‘ç”Ÿæ´»è€…ã€‚</li></ul><strong>èª²ç¨‹å…§å®¹æ ¸å¿ƒï¼š</strong><ul><li>å®‰å…¨æš–èº«èˆ‡é—œç¯€æ´»å‹•åº¦è¨“ç·´ã€‚</li><li>ä¸‹è‚¢åŠ›é‡ï¼ˆå¤§è…¿ã€è‡€éƒ¨ï¼‰å¼·åŒ–ï¼Œæå‡ç«™ç«‹èˆ‡è¡Œèµ°èƒ½åŠ›ã€‚</li><li>æ ¸å¿ƒè‚Œç¾¤ç©©å®šæ€§ç·´ç¿’ï¼Œä¿è­·è„Šæ¤ã€‚</li><li>èª²å¾Œèˆ’ç·©ä¼¸å±•ï¼Œæ”¾é¬†ç·Šç¹ƒè‚Œè‚‰ã€‚</li></ul><strong>è²¼å¿ƒæé†’ï¼š</strong> æœ¬èª²ç¨‹ç‚º [æˆ¶å¤–] èª²ç¨‹ï¼Œè«‹ç©¿è‘—è¼•ä¾¿èˆ’é©çš„æœè£ï¼Œä¸¦è‡ªå‚™æ°´å£ºã€æ¯›å·¾åŠå€‹äººé˜²æ›¬ç”¨å“ã€‚è®“å°ˆæ¥­çš„æˆ‘å€‘ï¼Œé™ªä¼´æ‚¨å¥åº·åœ°ã€Œæ¨‚ã€åœ¨å…¶ä¸­ï¼',
        instructor: 'é™³ç¾ç²è€å¸«',
        materials: 'éœ€è‡ªå‚™æ¯›å·¾ï¼Œå…¶ä»–å™¨æç”±èª²ç¨‹æä¾›',
        registrationDeadline: '2025/09/25',
        image: 'https://placehold.co/600x400?text=Muscle+Training'
      },
      { 
        id:'C105', 
        name:'é—œç¯€ä¿å¥æ“', 
        category: 'é‹å‹•å¥åº·',
        tags: ['ç‘œçˆ', 'å¾©å¥'], 
        day:'2025/11/06', 
        time:'10:30-11:30', 
        site:'Aæ£§3F å¤šåŠŸèƒ½å®¤', 
        maxSeats: 12,
        availableSeats: 0, 
        points: 300,
        sessions: 6,
        fee: 'æ‰£é»',
        note:'ä½è¡æ“Šé—œç¯€æ´»å‹•ï¼Œæ¸›å°‘åƒµç¡¬',
        description: 'é‡å°é—œç¯€ä¿é¤Šè¨­è¨ˆçš„æº«å’Œé‹å‹•ï¼Œæ”¹å–„é—œç¯€éˆæ´»åº¦èˆ‡æ¸›å°‘åƒµç¡¬æ„Ÿã€‚',
        instructor: 'åŠ‰æƒ æ•è€å¸«',
        materials: 'éœ€è‡ªå‚™ç‘œçˆå¢Šèˆ‡æ¯›å·¾',
        registrationDeadline: '2025/09/23',
        image: 'https://placehold.co/600x400?text=Joint+Care'
      },
      { 
        id:'C102', 
        name:'è…°èƒŒèˆ’ç·©æ ¸å¿ƒç‘œçˆ', 
        category: 'é‹å‹•å¥åº·',
        tags: ['ç‘œçˆ', 'èˆ’å±•'], 
        day:'2025/11/05', 
        time:'14:00-15:00', 
        site:'Bæ£§2F æ•™å®¤A', 
        maxSeats: 15,
        availableSeats: 2, 
        points: 300,
        sessions: 6,
        fee: 'æ‰£é»',
        note:'ä¼¸å±•èˆ‡å‘¼å¸ï¼Œæ”¾é¬†èº«å¿ƒ',
        description: 'æº«å’Œçš„ç‘œçˆç·´ç¿’ï¼Œè‘—é‡å‘¼å¸èª¿ç¯€èˆ‡æŸ”è»Ÿåº¦æå‡ï¼Œé©åˆéŠ€é«®æ—ç¾¤ã€‚',
        instructor: 'ç‹éœæ€¡è€å¸«',
        materials: 'éœ€è‡ªå‚™ç‘œçˆå¢Š',
        registrationDeadline: '2025/09/23',
        image: 'https://placehold.co/600x400?text=Yoga'
      },
      { 
        id:'C103', 
        name:'æ›¸æ³•è‡¨æ‘¹åˆç´šç­', 
        category: 'è—æ–‡ä¼‘é–’',
        tags: ['æ›¸æ³•', 'éœå¿ƒ'], 
        day:'2025/11/07', 
        time:'09:30-10:30', 
        site:'Aæ£§1F äº¤èª¼å»³', 
        maxSeats: 20,
        availableSeats: 8, 
        points: 400,
        sessions: 10,
        fee: 'æ‰£é»',
        note:'ç°¡æ˜“ç¯€å¥å‹•ä½œï¼Œå¼·åŒ–å¿ƒè‚º',
        description: 'çµåˆéŸ³æ¨‚èˆ‡ç°¡æ˜“å‹•ä½œçš„æœ‰æ°§é‹å‹•ï¼Œæå‡å¿ƒè‚ºåŠŸèƒ½èˆ‡å”èª¿æ€§ã€‚',
        instructor: 'æå¿—æ˜è€å¸«',
        materials: 'ç©¿è‘—èˆ’é©é‹å‹•æœå³å¯',
        registrationDeadline: '2025/09/26',
        image: 'https://placehold.co/600x400?text=Rhythm'
      },
      { 
        id:'C104', 
        name:'å¤æ—¥ç·¨ç¹”æç±ƒ', 
        category: 'è—æ–‡ä¼‘é–’',
        tags: ['æ‰‹ä½œ', 'ç·¨ç¹”'], 
        day:'2025/11/04', 
        time:'15:30-16:30', 
        site:'Cæ£§2F å…±å­¸å®¤', 
        maxSeats: 10,
        availableSeats: 5, 
        points: 600,
        sessions: 4,
        fee: 'æ‰£é»',
        note:'æ‰‹ä½œã€å”èª¿æ“ä½œï¼Œç¶­æŒå°ˆæ³¨',
        description: 'é€éç›Šæ™ºéŠæˆ²èˆ‡æ‰‹ä½œæ´»å‹•åˆºæ¿€å¤§è…¦ï¼Œç¶­æŒèªçŸ¥åŠŸèƒ½èˆ‡å°ˆæ³¨åŠ›ã€‚',
        instructor: 'å¼µéº—èŠ³è€å¸«',
        materials: 'ææ–™è²»å¦è¨ˆ NT$150',
        materialItems: [{name: 'ç·¨ç¹”ææ–™åŒ…', price: 150}],
        registrationDeadline: '2025/09/24',
        image: 'https://placehold.co/600x400?text=Brain+Training'
      },
      { 
        id:'C108', 
        name:'è–èª•èŠ±è—è¨­è¨ˆ', 
        category: 'è—æ–‡ä¼‘é–’',
        tags: ['æ‰‹ä½œ', 'èŠ±è—'], 
        day:'2025/12/05', 
        time:'14:00-16:00', 
        site:'Cæ£§2F å…±å­¸å®¤', 
        maxSeats: 15,
        availableSeats: 5, 
        points: 800,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'è–èª•ä¸»é¡ŒèŠ±è—ï¼Œå¢æ·»ç¯€æ—¥æ°£æ°›',
        description: 'å­¸ç¿’è£½ä½œè–èª•èŠ±åœˆèˆ‡æ¡ŒèŠ±ï¼Œä½¿ç”¨æ–°é®®èŠ±æèˆ‡è£é£¾å“ï¼Œç‚ºå®¶ä¸­å¢æ·»ç¯€æ—¥æ°£æ°›ã€‚',
        instructor: 'æ—é›…é›¯è€å¸«',
        materials: 'èŠ±æè²»å¦è¨ˆ 500 å…ƒ',
        materialItems: [{name: 'æ–°é®®èŠ±æ', price: 300}, {name: 'è–èª•è£é£¾å“', price: 200}],
        registrationDeadline: '2025/11/30',
        image: 'https://placehold.co/600x400?text=Christmas+Flower'
      },
      { 
        id:'C109', 
        name:'å†¬å­£é¤Šç”Ÿè—¥è†³', 
        category: 'ç”Ÿæ´»æ‡‰ç”¨',
        tags: ['çƒ¹é£ª', 'é¤Šç”Ÿ'], 
        day:'2025/12/10', 
        time:'10:00-12:00', 
        site:'Bæ£§1F å»šè—æ•™å®¤', 
        maxSeats: 20,
        availableSeats: 10, 
        points: 60000,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'å†¬å­£é€²è£œï¼Œå¥åº·ç¾å‘³',
        description: '<strong>ğŸ² å†¬å­£é¤Šç”Ÿè—¥è†³ï¼šæš–å¿ƒæš–èƒƒçš„å¥åº·ç¾å‘³</strong><br><br><strong>èª²ç¨‹ç°¡ä»‹ï¼š</strong> å¯’å†·çš„å†¬å¤©æ˜¯é€²è£œçš„æœ€ä½³æ™‚ç¯€ã€‚æœ¬èª²ç¨‹é‚€è«‹å°ˆæ¥­ä¸­é†«å¸«èˆ‡ç‡Ÿé¤Šå¸«ï¼Œæ•™æ‚¨å¦‚ä½•é‹ç”¨å¸¸è¦‹çš„ä¸­è—¥æçµåˆç•¶å­£é£Ÿæï¼Œçƒ¹èª¿å‡ºç¾å‘³åˆå¥åº·çš„é¤Šç”Ÿæ–™ç†ã€‚èª²ç¨‹ä¸­å°‡ä»‹ç´¹ä¸åŒé«”è³ªé©åˆçš„è—¥è†³ï¼Œä¸¦è¦ªæ‰‹è£½ä½œä¸€é“ç¶“å…¸è—¥è†³æ¹¯å“ã€‚<br><br><strong>èª°é©åˆåƒåŠ ï¼Ÿ</strong><ul><li>å®¹æ˜“æ‰‹è…³å†°å†·ã€ç•å¯’è€…ã€‚</li><li>å¸Œæœ›é€éé£²é£Ÿèª¿ç†æ”¹å–„é«”è³ªè€…ã€‚</li><li>å°ä¸­é†«è—¥è†³æ–™ç†æœ‰èˆˆè¶£è€…ã€‚</li></ul><strong>èª²ç¨‹å…§å®¹æ ¸å¿ƒï¼š</strong><ul><li>èªè­˜å¸¸è¦‹è—¥è†³é£ŸæåŠå…¶åŠŸæ•ˆã€‚</li><li>å­¸ç¿’å¦‚ä½•æŒ‘é¸èˆ‡è™•ç†ä¸­è—¥æã€‚</li><li>å¯¦ä½œç¤ºç¯„ï¼šç•¶æ­¸ç”Ÿè–‘ç¾Šè‚‰æ¹¯ / ç´ é£Ÿé¤Šç”Ÿæ¹¯ã€‚</li><li>ç¾å ´å“åšèˆ‡äº¤æµã€‚</li></ul>',
        instructor: 'å¼µåœ‹æ¦®è€å¸«',
        materials: 'é£Ÿæè²»å¦è¨ˆ 300 å…ƒ',
        materialItems: [{name: 'è—¥è†³é£ŸæåŒ…', price: 300}],
        registrationDeadline: '2025/12/05',
        image: 'https://placehold.co/600x400?text=Winter+Diet'
      },
      { 
        id:'C110', 
        name:'æ–°å¹´é–‹é‹æ›¸æ³•', 
        category: 'è—æ–‡ä¼‘é–’',
        tags: ['æ›¸æ³•', 'ç¯€æ…¶'], 
        day:'2025/12/15', 
        time:'15:00-16:30', 
        site:'Aæ£§1F äº¤èª¼å»³', 
        maxSeats: 20,
        availableSeats: 0, 
        points: 500,
        sessions: 2,
        fee: 'æ‰£é»',
        note:'æ®æ¯«å¯«æ˜¥è¯ï¼Œè¿æ¥æ–°æ°£è±¡',
        description: 'å­¸ç¿’æ›¸å¯«æ˜¥è¯èˆ‡å‰ç¥¥è©±ï¼Œé«”é©—å‚³çµ±æ›¸æ³•è—è¡“ï¼Œç‚ºæ–°çš„ä¸€å¹´å¸¶ä¾†å¥½é‹ã€‚',
        instructor: 'æå¿—æ˜è€å¸«',
        materials: 'éœ€è‡ªå‚™æ¯›ç­†ï¼Œç´™å¼µå¢¨æ±ç”±èª²ç¨‹æä¾›',
        materialItems: [{name: 'å°ˆæ¥­æ¯›ç­†', price: 200}, {name: 'ç‰¹è£½å¢¨æ±', price: 50}],
        registrationDeadline: '2025/12/10',
        image: 'https://placehold.co/600x400?text=Calligraphy'
      },
      { 
        id:'C111', 
        name:'å°Šæ¦®ç§äººæ•™ç·´èª²', 
        category: 'é‹å‹•å¥åº·',
        tags: ['å¥èº«', 'ä¸€å°ä¸€'], 
        day:'2025/12/20', 
        time:'10:00-11:00', 
        site:'Aæ£§3F å¥èº«æˆ¿', 
        maxSeats: 1,
        availableSeats: 0, 
        points: 61000,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'å°ˆå±¬æ•™ç·´æŒ‡å°',
        description: 'ç”±é ‚ç´šæ•™ç·´æä¾›çš„ä¸€å°ä¸€ç§äººå¥èº«æŒ‡å°ï¼Œé‡èº«æ‰“é€ å°ˆå±¬è¨“ç·´è¨ˆç•«ã€‚',
        instructor: 'ç‹å¤§è¡›æ•™ç·´',
        materials: 'éœ€è‡ªå‚™æ¯›å·¾',
        registrationDeadline: '2025/12/15',
        image: 'https://placehold.co/600x400?text=Private+Coach'
      },
      { 
        id:'C112', 
        name:'æ‰‹å·¥çš®ä»¶è£½ä½œ', 
        category: 'è—æ–‡ä¼‘é–’',
        tags: ['æ‰‹ä½œ', 'å·¥è—'], 
        day:'2025/12/25', 
        time:'14:00-16:00', 
        site:'Cæ£§2F å…±å­¸å®¤', 
        maxSeats: 8,
        availableSeats: 8, 
        points: 1000,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'è£½ä½œå°ˆå±¬çš®ä»¶ï¼Œé«”é©—å·¥åŒ ç²¾ç¥',
        description: '<strong>ğŸ‘œ æ‰‹å·¥çš®ä»¶è£½ä½œï¼šè³ªæ„Ÿç”Ÿæ´»ï¼Œè¦ªæ‰‹æ‰“é€ </strong><br><br><strong>èª²ç¨‹ç°¡ä»‹ï¼š</strong> é«”é©—çš®é©å·¥è—çš„é­…åŠ›ï¼Œå¾é¸çš®ã€è£åˆ‡ã€æ‰“å­”åˆ°ç¸«è£½ï¼Œè¦ªæ‰‹è£½ä½œä¸€å€‹ç¨ä¸€ç„¡äºŒçš„çœŸçš®é›¶éŒ¢åŒ…æˆ–è­‰ä»¶å¥—ã€‚èª²ç¨‹ç”±å°ˆæ¥­çš®ä»¶è¨­è¨ˆå¸«æŒ‡å°ï¼Œå³ä½¿æ˜¯åˆå­¸è€…ä¹Ÿèƒ½è¼•é¬†ä¸Šæ‰‹ã€‚<br><br><strong>èª²ç¨‹ç‰¹è‰²ï¼š</strong><ul><li>ä½¿ç”¨é«˜å“è³ªç¾©å¤§åˆ©æ¤é£é©ã€‚</li><li>å­¸ç¿’åŸºç¤çš®é©å·¥å…·ä½¿ç”¨èˆ‡æ‰‹ç¸«æŠ€å·§ã€‚</li><li>å¯å®¢è£½åŒ–åˆ»å­—ï¼Œæ‰“é€ å°ˆå±¬ç´€å¿µã€‚</li></ul>',
        instructor: 'é™³æµ©ç„¶è€å¸«',
        materials: 'ææ–™è²»å¦è¨ˆ NT$800 (å«çš®é©ã€äº”é‡‘ã€å·¥å…·ç§Ÿå€Ÿ)',
        materialItems: [{name: 'ç¾©å¤§åˆ©æ¤é£é©', price: 500}, {name: 'äº”é‡‘é…ä»¶çµ„', price: 300}],
        registrationDeadline: '2025/12/20',
        image: 'https://placehold.co/600x400?text=Leather+Craft'
      },
      { 
        id:'C113', 
        name:'AI ç”Ÿæ´»æ‡‰ç”¨å…¥é–€', 
        category: 'ç§‘æŠ€æ–°çŸ¥',
        tags: ['AI', 'ç§‘æŠ€'], 
        day:'2026/01/05', 
        time:'10:00-12:00', 
        site:'Aæ£§2F é›»è…¦æ•™å®¤', 
        maxSeats: 20,
        availableSeats: 15, 
        points: 500,
        sessions: 4,
        fee: 'æ‰£é»',
        note:'å­¸ç¿’ä½¿ç”¨ AI å·¥å…·ï¼Œæå‡ç”Ÿæ´»ä¾¿åˆ©æ€§',
        description: 'ä»‹ç´¹ ChatGPT ç­‰ AI å·¥å…·çš„åŸºæœ¬æ“ä½œèˆ‡ç”Ÿæ´»æ‡‰ç”¨ï¼Œè®“ç§‘æŠ€æˆç‚ºæ‚¨çš„å¥½å¹«æ‰‹ã€‚',
        instructor: 'ç‹å°æ˜è€å¸«',
        materials: 'éœ€è‡ªå‚™æ™ºæ…§å‹æ‰‹æ©Ÿæˆ–å¹³æ¿',
        registrationDeadline: '2025/12/30',
        image: 'https://placehold.co/600x400?text=AI+Life'
      },
      { 
        id:'C114', 
        name:'æ­£å¿µæ¸›å£“å·¥ä½œåŠ', 
        category: 'å¿ƒéˆæˆé•·',
        tags: ['æ­£å¿µ', 'ç´“å£“'], 
        day:'2026/01/08', 
        time:'14:00-16:00', 
        site:'Bæ£§3F éœå¿ƒå®¤', 
        maxSeats: 15,
        availableSeats: 10, 
        points: 600,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'å­¸ç¿’æ­£å¿µå‘¼å¸ï¼Œé‡‹æ”¾å£“åŠ›',
        description: 'é€éæ­£å¿µç·´ç¿’ï¼Œè¦ºå¯Ÿç•¶ä¸‹ï¼Œé‡‹æ”¾èº«å¿ƒå£“åŠ›ï¼Œæ‰¾å›å…§å¿ƒçš„å¹³éœã€‚',
        instructor: 'æ—éœå®œè€å¸«',
        materials: 'ç©¿è‘—å¯¬é¬†èˆ’é©è¡£ç‰©',
        registrationDeadline: '2026/01/03',
        image: 'https://placehold.co/600x400?text=Mindfulness'
      },
      { 
        id:'C115', 
        name:'æ—…éŠè‹±èªæœƒè©±', 
        category: 'èªè¨€å­¸ç¿’',
        tags: ['è‹±èª', 'æ—…éŠ'], 
        day:'2026/01/10', 
        time:'19:00-20:30', 
        site:'Aæ£§1F äº¤èª¼å»³', 
        maxSeats: 15,
        availableSeats: 5, 
        points: 800,
        sessions: 8,
        fee: 'æ‰£é»',
        note:'å¯¦ç”¨æ—…éŠè‹±èªï¼Œå‡ºåœ‹æºé€šç„¡éšœç¤™',
        description: 'æ¨¡æ“¬æ©Ÿå ´ã€é£¯åº—ã€é¤å»³ç­‰æƒ…å¢ƒï¼Œç·´ç¿’å¯¦ç”¨è‹±èªæœƒè©±ï¼Œè®“æ‚¨å‡ºåœ‹æ—…éŠæ›´è‡ªä¿¡ã€‚',
        instructor: 'David Smith',
        materials: 'è¬›ç¾©è²» 200 å…ƒ',
        materialFee: 200,
        registrationDeadline: '2026/01/05',
        image: 'https://placehold.co/600x400?text=Travel+English'
      },
      { 
        id:'C116', 
        name:'è¦ªå­ç§‘å­¸å¯¦é©—å®¤', 
        category: 'è¦ªå­å…±å­¸',
        tags: ['ç§‘å­¸', 'è¦ªå­'], 
        day:'2026/01/12', 
        time:'10:00-11:30', 
        site:'Cæ£§1F å¯¦é©—å®¤', 
        maxSeats: 10,
        availableSeats: 3, 
        points: 1200,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'è¦ªå­å‹•æ‰‹åšå¯¦é©—ï¼Œæ¿€ç™¼ç§‘å­¸èˆˆè¶£',
        description: 'é€éæœ‰è¶£çš„ç§‘å­¸å¯¦é©—ï¼ŒåŸ¹é¤Šå­©å­çš„è§€å¯ŸåŠ›èˆ‡å¥½å¥‡å¿ƒï¼Œå¢é€²è¦ªå­äº’å‹•ã€‚',
        instructor: 'ç§‘å­¸æ€ªäººåœ˜éšŠ',
        materials: 'å«å¯¦é©—ææ–™åŒ…',
        registrationDeadline: '2026/01/07',
        image: 'https://placehold.co/600x400?text=Science+Lab'
      },
      { 
        id:'C117', 
        name:'åŸå¸‚ç”Ÿæ…‹å°è¦½', 
        category: 'æˆ¶å¤–æ¢ç´¢',
        tags: ['ç”Ÿæ…‹', 'å°è¦½'], 
        day:'2026/01/15', 
        time:'09:00-11:00', 
        site:'å¤§å®‰æ£®æ—å…¬åœ’', 
        maxSeats: 20,
        availableSeats: 18, 
        points: 300,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'èªè­˜åŸå¸‚ç”Ÿæ…‹ï¼Œè¦ªè¿‘è‡ªç„¶',
        description: 'ç”±å°ˆæ¥­å°è¦½å“¡å¸¶é ˜ï¼Œæ¢ç´¢åŸå¸‚ä¸­çš„ç”Ÿæ…‹å¥§ç§˜ï¼Œèªè­˜å¸¸è¦‹çš„å‹•æ¤ç‰©ã€‚',
        instructor: 'ç¶ è‰²å”æœƒ',
        materials: 'è‡ªå‚™æ°´å£ºã€é˜²æ›¬ç”¨å“',
        registrationDeadline: '2026/01/10',
        image: 'https://placehold.co/600x400?text=Eco+Tour'
      },
      { 
        id:'C118', 
        name:'é€€ä¼‘ç†è²¡è¦åŠƒ', 
        category: 'ç†è²¡è¦åŠƒ',
        tags: ['ç†è²¡', 'é€€ä¼‘'], 
        day:'2026/01/18', 
        time:'14:00-16:00', 
        site:'Aæ£§3F æœƒè­°å®¤', 
        maxSeats: 30,
        availableSeats: 25, 
        points: 500,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'è¦åŠƒé€€ä¼‘è²¡å‹™ï¼Œäº«å—å¯Œè¶³äººç”Ÿ',
        description: 'åˆ†æé€€ä¼‘é‡‘ä¾†æºèˆ‡éœ€æ±‚ï¼Œä»‹ç´¹é©åˆé€€ä¼‘æ—çš„ç†è²¡å·¥å…·èˆ‡è³‡ç”¢é…ç½®ç­–ç•¥ã€‚',
        instructor: 'é™³è²¡å¯Œé¡§å•',
        materials: 'è‡ªå‚™ç­†è¨˜æœ¬',
        registrationDeadline: '2026/01/13',
        image: 'https://placehold.co/600x400?text=Finance'
      },
      { 
        id:'C119', 
        name:'éæ´²é¼“æ‰“æ“Šæ¨‚', 
        category: 'éŸ³æ¨‚å¾‹å‹•',
        tags: ['éŸ³æ¨‚', 'æ‰“æ“Šæ¨‚'], 
        day:'2026/01/20', 
        time:'19:00-20:30', 
        site:'Bæ£§2F éŸ³æ¨‚æ•™å®¤', 
        maxSeats: 15,
        availableSeats: 8, 
        points: 800,
        sessions: 8,
        fee: 'æ‰£é»',
        note:'æ„Ÿå—ç¯€å¥å¾‹å‹•ï¼Œé‡‹æ”¾ç†±æƒ…',
        description: 'å­¸ç¿’éæ´²é¼“çš„åŸºæœ¬æ‰“æ³•èˆ‡ç¯€å¥ï¼Œé€éåœ˜é«”åˆå¥ï¼Œæ„Ÿå—éŸ³æ¨‚çš„å¿«æ¨‚èˆ‡èƒ½é‡ã€‚',
        instructor: 'é¼“å‹•äººå¿ƒæ¨‚åœ˜',
        materials: 'éœ€ç§Ÿå€Ÿéæ´²é¼“ 500 å…ƒ/æœŸ',
        materialFee: 500,
        registrationDeadline: '2026/01/15',
        image: 'https://placehold.co/600x400?text=African+Drum'
      },
      { 
        id:'C120', 
        name:'å±…å®¶æ¤æ ½é¤Šè­·', 
        category: 'åœ’è—æ¤æ ½',
        tags: ['åœ’è—', 'æ¤æ ½'], 
        day:'2026/01/22', 
        time:'10:00-12:00', 
        site:'Cæ£§1F åœ’è—å€', 
        maxSeats: 15,
        availableSeats: 12, 
        points: 600,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'æ‰“é€ ç¶ æ„å±…å®¶ï¼Œç™‚ç™’èº«å¿ƒ',
        description: 'ä»‹ç´¹é©åˆå®¤å…§ç¨®æ¤çš„æ¤ç‰©ï¼Œå­¸ç¿’æ¾†æ°´ã€æ–½è‚¥ã€æ›ç›†ç­‰é¤Šè­·æŠ€å·§ã€‚',
        instructor: 'ç¶ æ‰‹æŒ‡å·¥ä½œå®¤',
        materials: 'å«ä¸€ç›†å°æ¤æ ½',
        registrationDeadline: '2026/01/17',
        image: 'https://placehold.co/600x400?text=Gardening'
      },
      { 
        id:'C121', 
        name:'èŒ¶é“æ–‡åŒ–é«”é©—', 
        category: 'å“èŒ¶è—è¡“',
        tags: ['èŒ¶é“', 'æ–‡åŒ–'], 
        day:'2026/01/25', 
        time:'14:00-16:00', 
        site:'Bæ£§3F èŒ¶å®¤', 
        maxSeats: 10,
        availableSeats: 5, 
        points: 1000,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'å“å‘³èŒ¶é¦™ï¼Œé«”é©—èŒ¶é“ç²¾ç¥',
        description: 'èªè­˜èŒ¶è‘‰ç¨®é¡èˆ‡æ³¡èŒ¶å™¨å…·ï¼Œå­¸ç¿’æ³¡èŒ¶ç¦®å„€èˆ‡å“èŒ¶æŠ€å·§ï¼Œæ„Ÿå—èŒ¶é“ä¹‹ç¾ã€‚',
        instructor: 'æ—èŒ¶å¸«',
        materials: 'å«èŒ¶é»ä¸€ä»½',
        registrationDeadline: '2026/01/20',
        image: 'https://placehold.co/600x400?text=Tea+Ceremony'
      },
      { 
        id:'C122', 
        name:'æ‰‹æ©Ÿæ”å½±å¯¦æˆ°', 
        category: 'æ”å½±æŠ€å·§',
        tags: ['æ”å½±', 'æ‰‹æ©Ÿ'], 
        day:'2026/01/28', 
        time:'09:00-12:00', 
        site:'æˆ¶å¤–/Aæ£§1F', 
        maxSeats: 20,
        availableSeats: 10, 
        points: 800,
        sessions: 1,
        fee: 'æ‰£é»',
        note:'ç”¨æ‰‹æ©Ÿæ‹å‡ºç¾ç…§ï¼Œè¨˜éŒ„ç”Ÿæ´»',
        description: 'æŒæ¡æ‰‹æ©Ÿæ”å½±çš„å…‰å½±ã€æ§‹åœ–èˆ‡ä¿®åœ–æŠ€å·§ï¼Œè¼•é¬†æ‹å‡ºä»¤äººé©šè±”çš„ç…§ç‰‡ã€‚',
        instructor: 'å¼µæ”æ‰‹',
        materials: 'è‡ªå‚™æ™ºæ…§å‹æ‰‹æ©Ÿ',
        registrationDeadline: '2026/01/23',
        image: 'https://placehold.co/600x400?text=Mobile+Photo'
      }
    ];

    let currentFilterDay = 'all';
    let activeCategories = new Set();
    let tempCategories = new Set();

    function initDayFilter() {
        const days = new Set();
        const weekdays = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
        
        COURSES.forEach(c => {
            const dateObj = new Date(c.day);
            if (!isNaN(dateObj.getTime())) {
                const dayName = weekdays[dateObj.getDay()];
                days.add(dayName);
            }
        });

        // Sort days based on weekdays order
        const sortedDays = Array.from(days).sort((a, b) => {
            return weekdays.indexOf(a) - weekdays.indexOf(b);
        });

        const container = document.getElementById('dayFilterContainer');
        if (!container) return;

        let html = '<button class="filter-chip active" data-day="all">å…¨éƒ¨æ—¥æœŸ</button>';
        
        sortedDays.forEach(day => {
            html += `<button class="filter-chip" data-day="${day}">${day}</button>`;
        });
        
        container.innerHTML = html;

        // Add event listeners
        container.querySelectorAll('.filter-chip').forEach(chip => {
            chip.addEventListener('click', () => {
                container.querySelectorAll('.filter-chip').forEach(c => c.classList.remove('active'));
                chip.classList.add('active');
                currentFilterDay = chip.dataset.day;
                filter();
            });
        });
    }

    function initTagFilter() {
        const categories = new Set();
        
        COURSES.forEach(c => {
            if (c.category) categories.add(c.category);
        });
        
        const container = document.getElementById('filterOptions');
        if (!container) return;

        let html = '';
        
        // Categories Section
        html += `<div style="grid-column: 1 / -1; font-weight:700; color:#374151; margin-bottom:8px;">è«‹é¸æ“‡æœ‰èˆˆè¶£çš„èª²ç¨‹é¡åˆ¥ (è¤‡é¸)</div>`;
        html += `<div style="grid-column: 1 / -1; display:flex; flex-wrap:wrap; gap:8px; margin-bottom:16px;">`;
        
        categories.forEach(cat => {
            html += `
                <label class="filter-chip-option category-option" data-value="${cat}" style="padding:8px 16px; border:1px solid #00b4b4; border-radius:20px; cursor:pointer; font-size:14px;">
                    ${cat}
                    <input type="checkbox" name="filterCategory" value="${cat}" style="display:none;">
                </label>
            `;
        });
        html += `</div>`;

        container.innerHTML = html;
        
        // Event Listeners
        container.querySelectorAll('input[name="filterCategory"]').forEach(cb => {
            cb.addEventListener('change', (e) => {
                if(e.target.checked) tempCategories.add(e.target.value);
                else tempCategories.delete(e.target.value);
                updateFilterOptionStyles();
            });
        });
    }

    function updateFilterOptionStyles() {
        // Update Category Styles
        document.querySelectorAll('.category-option').forEach(label => {
            const cb = label.querySelector('input');
            if(cb.checked) {
                label.style.backgroundColor = '#00b4b4';
                label.style.color = '#fff';
                label.style.borderColor = '#00b4b4';
            } else {
                label.style.backgroundColor = '#fff';
                label.style.color = '#374151';
                label.style.borderColor = '#99e1e1';
            }
        });
    }

    function getBookedCourseStatus() {
        const KEY = 'sl_course_bookings';
        let list = [];
        try { list = JSON.parse(localStorage.getItem(KEY) || '[]'); } catch { list = []; }
        
        const statusMap = new Map();
        list.forEach(item => {
            // Check if status is NOT cancelled
            if (item.status !== 'å·²å–æ¶ˆ' && item.status !== 'å–æ¶ˆå€™è£œ') {
                statusMap.set(item.courseId, item.status);
            }
        });
        return statusMap;
    }

    function render(list){
      const host = document.getElementById('courseList');
      host.innerHTML='';
      
      if (list.length === 0) {
        host.innerHTML = '<div style="text-align:center; padding:40px; color:#999;">æ²’æœ‰ç¬¦åˆæ¢ä»¶çš„èª²ç¨‹</div>';
        return;
      }

      const bookedStatusMap = getBookedCourseStatus();

      list.forEach((c, index) => {
        const isFull = c.availableSeats === 0;
        const bookingStatus = bookedStatusMap.get(c.id);
        const isBooked = !!bookingStatus;

        // Logic: If full, show "å€™è£œ" and enable button.
        let btnText = isFull ? 'æˆ‘è¦å€™è£œ' : 'ç«‹å³é ç´„';
        let btnClass = isFull ? 'btn-waitlist' : 'btn-book';
        let btnAttr = '';

        if (isBooked) {
            if (bookingStatus === 'å€™è£œä¸­') {
                btnText = 'å€™è£œä¸­';
                btnClass = 'btn-disabled'; // Or keep waitlist style but disabled
                btnAttr = 'disabled';
            } else {
                btnText = 'å·²å ±å';
                btnClass = 'btn-disabled';
                btnAttr = 'disabled';
            }
        }
        
        // Format date and time
        let displayTime = '';
        let weekday = '';
        const dateObj = new Date(c.day);
        
        if (!isNaN(dateObj.getTime())) {
          const weekdays = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
          weekday = weekdays[dateObj.getDay()];
          const year = dateObj.getFullYear();
          const month = String(dateObj.getMonth() + 1).padStart(2, '0');
          const day = String(dateObj.getDate()).padStart(2, '0');
          const formattedDate = `${year}/${month}/${day}`;
          displayTime = `${formattedDate} ${weekday} ${c.time}`;
        } else {
          displayTime = `${c.day} ï½œ ${c.time}`;
        }
        
        // Handle tags and category
        let tagsHtml = '';

        if (c.category) {
            tagsHtml += `<span class="badge" style="background:rgb(25,79,91,0.08); color:rgb(25,79,91,0.8); margin-right:4px;">${c.category}</span>`;
        }
        if (c.tags && Array.isArray(c.tags)) {
          tagsHtml += c.tags.map(tag => `<span class="badge badge-type" style="margin-right:4px;background:rgb(25,79,91,0.08); color:rgb(25,79,91,0.8);">#${tag}</span>`).join('');
        } else if (c.type) {
           tagsHtml += `<span class="badge badge-type">${c.type}</span>`;
        }

        const card = document.createElement('div');
        card.className='course-card';
        
        card.innerHTML = `
          <div class="course-header">
            <div class="course-title-group">
              
              <div class="course-title">
                <span class="course-name" data-detail="${c.id}">${c.name}</span>
                <div style="font-size: 16px; color: #666; font-weight: normal; margin-top: 4px;">èª²ç¨‹ä»£ç¢¼ï¼š${c.id}</div>
              </div>
            </div>
          </div>
          
          <div>
            <div class="course-time">
                <img src="./images/fa-calendar-day.svg"> ${displayTime}
            </div>
            <div style="display: flex; gap:8px; align-items: center; margin-bottom: 4px; flex-wrap: wrap;">
                <div class="course-location" style="margin-bottom: 0;">
                     ${c.site}
                </div>
                <div style="color: #999;">|</div>
                <div class="course-instructor" style="font-size: 16px; color: #666; display: flex; align-items: center; gap: 8px;">
                     ${c.instructor}
                </div>
            </div>
             <div class="course-points">
                <img src="./images/money-icon.png"> ${c.points} é»
            </div>
          </div>
          
          <div style="display:flex; flex-wrap:wrap; gap:4px;">
            ${tagsHtml}
          </div>

          <div class="course-actions" style="display: flex; gap: 10px; margin-top: 12px;">
            <button class="btn-ghost-2" onclick="window.location.href='course-detail.html?id=${c.id}'" style="flex: 1;">èª²ç¨‹æ´»å‹•è³‡è¨Š</button>
            <button class="${btnClass}" ${isBooked ? '' : `data-book="${c.id}"`} ${btnAttr} style="flex: 1;">${btnText}</button>
          </div>
        `;
        host.appendChild(card);
      });
    }

    function filter(){
      let list = [...COURSES];
      const bookedStatusMap = getBookedCourseStatus();
      
      // Filter by day
      if (currentFilterDay !== 'all') {
        list = list.filter(c => {
            const dateObj = new Date(c.day);
            if (isNaN(dateObj.getTime())) return false;
            const weekdays = ['é€±æ—¥', 'é€±ä¸€', 'é€±äºŒ', 'é€±ä¸‰', 'é€±å››', 'é€±äº”', 'é€±å…­'];
            const dayName = weekdays[dateObj.getDay()];
            return dayName === currentFilterDay;
        });
      }

      // Filter by Category
      if (activeCategories.size > 0) {
          list = list.filter(c => activeCategories.has(c.category));
      }

      // Sort logic:
      // 1. Available & Not Booked (Priority 1)
      // 2. Full (Waitlist) & Not Booked (Priority 2)
      // 3. Booked (Priority 3)
      // Within same priority, sort by date (soonest first)
      list.sort((a, b) => {
        const isBookedA = bookedStatusMap.has(a.id);
        const isFullA = a.availableSeats === 0;
        let scoreA = 3;
        if (!isBookedA && !isFullA) scoreA = 1;
        else if (!isBookedA && isFullA) scoreA = 2;

        const isBookedB = bookedStatusMap.has(b.id);
        const isFullB = b.availableSeats === 0;
        let scoreB = 3;
        if (!isBookedB && !isFullB) scoreB = 1;
        else if (!isBookedB && isFullB) scoreB = 2;

        if (scoreA !== scoreB) {
            return scoreA - scoreB;
        }

        return new Date(a.day) - new Date(b.day);
      });
      
      render(list);

      // Update Filter Button UI
      const countEl = document.getElementById('filterCount');
      const btn = document.getElementById('openFilterBtn');
      if(countEl && btn) {
        let count = activeCategories.size;
        if(count > 0) {
            countEl.textContent = count;
            countEl.style.display = 'inline-block';
            btn.style.borderColor = '#00b0ff';
            btn.style.color = '#00b0ff';
            btn.style.background = '#f0f9ff';
        } else {
            countEl.style.display = 'none';
            btn.style.borderColor = '#e5e7eb';
            btn.style.color = '#374151';
            btn.style.background = 'white';
        }
      }
    }

    let currentCourse = null;
    let selectedPayment = 'points';

    function selectOption(element, type) {
        const siblings = element.parentElement.querySelectorAll('.option-card');
        siblings.forEach(el => el.classList.remove('selected'));
        element.classList.add('selected');
        
        const value = element.getAttribute('data-value');
        if (type === 'payment') {
            selectedPayment = value;
        }
    }

    // é»æ•¸ç®¡ç†å‡½æ•¸
    function getUserPoints() {
      return parseInt(localStorage.getItem('sl_user_points') || '13700');
    }

    function deductPoints(points) {
      const currentPoints = getUserPoints();
      const newPoints = Math.max(0, currentPoints - points);
      localStorage.setItem('sl_user_points', newPoints.toString());
    }

    // æ›å¸³ç®¡ç†å‡½æ•¸
    function addChargeAmount(amount) {
      const currentCharge = parseInt(localStorage.getItem('sl_charge_amount') || '0');
      const newCharge = currentCharge + amount;
      localStorage.setItem('sl_charge_amount', newCharge.toString());
    }

    function getChargeAmount() {
      return parseInt(localStorage.getItem('sl_charge_amount') || '0');
    }

    function getSelectedMaterials() {
        const container = document.getElementById('material-items-container');
        const selected = [];
        container.querySelectorAll('.option-card.selected').forEach(card => {
            selected.push({
                name: card.dataset.name,
                price: parseInt(card.dataset.price)
            });
        });
        return selected;
    }

    function updateTotalCharge() {
        if (!currentCourse) return;
        
        const selectedMaterials = getSelectedMaterials();
        const materialTotal = selectedMaterials.reduce((sum, item) => sum + item.price, 0);
        
        // Update bill sub text if paying by bill
        // But bill-sub is for "Pay by Bill" option which includes course fee + material fee
        // Or is it just the extra charge?
        // In openSheet: const chargeAmount = c.points * 10; document.getElementById('bill-sub').textContent = ...
        
        // Let's update the display if needed. 
        // Actually, the bill-sub usually shows the course price in NT$.
        // Material fee is separate or added?
        // In the original code:
        // if (paymentMethod === 'bill') chargeAmount = (pointsNeeded * 10) + materialFee;
        
        // So we should probably update the UI to reflect total if bill is selected?
        // The current UI has separate sections.
        // Let's just ensure confirmBooking calculates correctly.
    }

    function openSheet(courseId){
      const c = COURSES.find(x=>x.id===courseId);
      if(!c) return;
      currentCourse = c;
      
      document.getElementById('s-name').textContent=c.name;
      document.getElementById('s-code').textContent=c.id;
      document.getElementById('s-time').textContent=`${c.day} ${c.time}`;
      document.getElementById('s-site').textContent=c.site;
      document.getElementById('s-instructor').textContent=c.instructor || 'å°ˆæ¥­è¬›å¸«';
      // document.getElementById('s-img').src = c.image || 'https://placehold.co/80x80';
      document.getElementById('s-points').textContent = `${c.points} é»`;
      
      document.querySelector('.view-details-link').href = `course-detail.html?id=${c.id}`;
      
      const userPoints = getUserPoints();
      const pointsSub = document.getElementById('points-sub');
      pointsSub.textContent = `ç¾æœ‰é»æ•¸: ${userPoints.toLocaleString()}é»`;
      
      if (userPoints >= c.points) {
          pointsSub.innerHTML += ' <span style="color:#b3a68b; font-weight:bold; font-size:14px; margin-left:4px;"><i class="fas fa-check-circle"></i> é»æ•¸è¶³å¤ </span>';
      } else {
          pointsSub.innerHTML += ' <span style="color:#d32f2f; font-weight:bold; font-size:14px; margin-left:4px;"><i class="fas fa-times-circle"></i> é»æ•¸ä¸è¶³</span>';
      }
      
      const chargeAmount = c.points * 10;
      document.getElementById('bill-sub').textContent = `NT$ ${chargeAmount.toLocaleString()}`;

      // Material Fee Logic
      const materialSection = document.getElementById('material-fee-section');
      const materialContainer = document.getElementById('material-items-container');
      materialContainer.innerHTML = ''; // Clear previous items
      
      let hasMaterials = false;

      if (c.materialItems && c.materialItems.length > 0) {
          hasMaterials = true;
          c.materialItems.forEach((item, index) => {
              const itemDiv = document.createElement('div');
              itemDiv.className = 'option-card selected';
              itemDiv.style.cursor = 'pointer';
              itemDiv.dataset.price = item.price;
              itemDiv.dataset.name = item.name;
              itemDiv.onclick = function() {
                  this.classList.toggle('selected');
                  updateTotalCharge();
              };

              itemDiv.innerHTML = `
                <div class="option-content">
                    <div class="option-icon"><i class="fas fa-tools"></i></div>
                    <div class="option-text">
                        <span class="option-label">${item.name}</span>
                        <span class="option-sub">NT$ ${item.price.toLocaleString()}</span>
                    </div>
                </div>
                <div class="radio-circle"></div>
              `;
              materialContainer.appendChild(itemDiv);
          });
      } else if (c.materialFee && c.materialFee > 0) {
          // Legacy support for single fee
          hasMaterials = true;
          const itemDiv = document.createElement('div');
          itemDiv.className = 'option-card selected';
          itemDiv.style.cursor = 'pointer'; // Allow deselection
          itemDiv.dataset.price = c.materialFee;
          itemDiv.dataset.name = 'ææ–™è²»';
          itemDiv.onclick = function() {
              this.classList.toggle('selected');
              updateTotalCharge();
          };

          itemDiv.innerHTML = `
            <div class="option-content">
                <div class="option-icon"><i class="fas fa-tools"></i></div>
                <div class="option-text">
                    <span class="option-label">ææ–™è²»ç”¨</span>
                    <span class="option-sub">NT$ ${c.materialFee.toLocaleString()}</span>
                </div>
            </div>
            <div class="radio-circle"></div>
          `;
          materialContainer.appendChild(itemDiv);
      }

      if (hasMaterials) {
          materialSection.style.display = 'block';
          const materialDesc = document.getElementById('material-description');
          if (materialDesc) {
              materialDesc.innerHTML = c.materials || '';
          }
      } else {
          materialSection.style.display = 'none';
      }

      // Initial calculation
      updateTotalCharge();

      const isFull = c.availableSeats === 0;
      const paymentSection = document.getElementById('payment-section');
      
      if (isFull) {
          paymentSection.style.display = 'none';
          selectedPayment = null;
          document.querySelector('.modal-header h2').textContent = 'èª²ç¨‹é ç´„ç¢ºèª'; // Match image title
      } else {
          paymentSection.style.display = 'block';
          selectedPayment = 'points';
          const paymentOptions = paymentSection.querySelectorAll('.option-card');
          paymentOptions.forEach(el => el.classList.remove('selected'));
          paymentSection.querySelector('[data-value="points"]').classList.add('selected');
          document.querySelector('.modal-header h2').textContent = 'èª²ç¨‹æ´»å‹•é ç´„ç¢ºèª';
      }

      const btn = document.getElementById('confirmBooking');
      
      if (isFull) {
        btn.textContent = 'ç¢ºèªå€™è£œ';
      } else {
        btn.textContent = 'ç¢ºèªé ç´„';
      }
      
      document.getElementById('modal').style.display='flex';
    }
    function closeSheet(){ document.getElementById('modal').style.display='none'; }

    function showPopup(title, message, onConfirm, onCancel, showCancelButton = false) {
        console.log('showPopup called:', title);
        const popup = document.getElementById('messagePopup');
        if (!popup) {
            console.error('Popup element not found');
            return;
        }

        const titleEl = document.getElementById('popupTitle');
        const msgEl = document.getElementById('popupMessage');
        const confirmBtn = document.getElementById('popupConfirm');
        const cancelBtn = document.getElementById('popupCancel');
        const iconEl = document.getElementById('popupIcon');

        titleEl.textContent = title;
        msgEl.textContent = message;

        // Icon selection
        if (title.includes('æˆåŠŸ') || title.includes('åŠ å…¥')) {
            iconEl.innerHTML = '<i class="fas fa-check-circle"></i>';
            iconEl.style.color = '#2e7d32'; // Green
            
            // Special handling for waitlist success to match image
            if (title === 'å·²åŠ å…¥å€™è£œ') {
                iconEl.innerHTML = '<div style="width: 60px; height: 60px; background: #2e7d32; border-radius: 50%; display: flex; justify-content: center; align-items: center; margin: 0 auto;"><i class="fas fa-check" style="color: white; font-size: 32px;"></i></div>';
                iconEl.style.color = ''; // Reset color as it's handled in innerHTML
            }
        } else if (title.includes('ä¸è¶³') || title.includes('å¤±æ•—')) {
            iconEl.innerHTML = '<i class="fas fa-exclamation-circle"></i>';
            iconEl.style.color = '#d32f2f'; // Red
        } else {
            iconEl.innerHTML = '<i class="fas fa-info-circle"></i>';
            iconEl.style.color = '#00b0ff'; // Blue
        }

        if (showCancelButton) {
            cancelBtn.style.display = 'block';
            cancelBtn.onclick = () => {
                popup.style.display = 'none';
                popup.classList.remove('show');
                popup.style.opacity = '0';
                if (onCancel) onCancel();
            };
        } else {
            cancelBtn.style.display = 'none';
        }

        confirmBtn.onclick = () => {
            popup.style.display = 'none';
            popup.classList.remove('show');
            popup.style.opacity = '0';
            if (onConfirm) onConfirm();
        };

        popup.style.display = 'flex';
        // Force visibility properties to override any conflicting CSS
        popup.style.opacity = '1';
        popup.classList.add('show');
        popup.style.zIndex = '9999'; 
        console.log('Popup displayed');
    }

    document.addEventListener('DOMContentLoaded', ()=>{
      // For Demo: Always reset C999 booking status to allow testing waitlist flow
      const KEY = 'sl_course_bookings';
      try { 
          let list = JSON.parse(localStorage.getItem(KEY) || '[]'); 
          const newList = list.filter(item => item.courseId !== 'C999');
          if (list.length !== newList.length) {
              localStorage.setItem(KEY, JSON.stringify(newList));
          }
      } catch(e) {}

      // Ensure sufficient points for testing scenario
      if(getUserPoints() < 10000) {
          localStorage.setItem('sl_user_points', '50000');
      }

      // Header hint if redirected
      const usp = new URLSearchParams(location.search);
      if(usp.get('from')==='home'){
        const note=document.createElement('div');
        note.style.cssText='margin:0 0 12px 0;padding:10px 12px;border-radius:12px;background:#eef6ff;color:#0d47a1;font-weight:600;';
        note.innerHTML='<i class="fas fa-circle-info"></i> æ­¡è¿é ç´„é©åˆé«˜é½¡è€…çš„èª²ç¨‹';
        document.querySelector('.main-content').prepend(note);
      }

      initDayFilter();
      initTagFilter();

      // Filter Modal Events
      const filterModal = document.getElementById('filterModal');
      document.getElementById('openFilterBtn').addEventListener('click', () => {
          tempCategories = new Set(activeCategories);
          
          document.querySelectorAll('#filterOptions input[name="filterCategory"]').forEach(cb => {
              cb.checked = tempCategories.has(cb.value);
          });

          updateFilterOptionStyles();
          filterModal.style.display = 'flex';
      });

      document.getElementById('closeFilterModal').addEventListener('click', () => {
          filterModal.style.display = 'none';
      });

      document.getElementById('resetFilter').addEventListener('click', () => {
          tempCategories.clear();
          document.querySelectorAll('#filterOptions input').forEach(cb => {
              cb.checked = false;
          });

          updateFilterOptionStyles();
      });

      document.getElementById('applyFilter').addEventListener('click', () => {
          activeCategories = new Set(tempCategories);
          filter();
          filterModal.style.display = 'none';
      });

      document.body.addEventListener('click', (e)=>{
        const bookId = e.target.getAttribute?.('data-book');
        const detailId = e.target.getAttribute?.('data-detail');
        
        if(bookId){ openSheet(bookId); }
        if(detailId){ window.location.href = `course-detail.html?id=${detailId}`; }
      });
      document.getElementById('closeSheet')?.addEventListener('click', closeSheet);
      document.getElementById('confirmBooking')?.addEventListener('click', (e)=>{
        e.preventDefault();
        e.stopPropagation();
        console.log('Confirm button clicked');
        
        if (!currentCourse) {
            console.error('No current course selected');
            return;
        }

        const course = currentCourse;
        const isWaitlist = course.availableSeats === 0;
        console.log('Course:', course.id, 'Is Waitlist:', isWaitlist);

        const pointsNeeded = course.points;
        
        // Calculate material fee from selected items
        const selectedMaterials = getSelectedMaterials();
        const totalMaterialFee = selectedMaterials.reduce((sum, item) => sum + item.price, 0);

        let paymentMethod = selectedPayment;
        let chargeAmount = 0;

        const executeBooking = (finalPaymentMethod, finalChargeAmount) => {
            console.log('Executing booking', finalPaymentMethod, finalChargeAmount);
            // å„²å­˜é ç´„è¨˜éŒ„
            const id = `${course.id}-${Date.now()}`;
            let start = new Date();
            
            if(course.day.includes('/')){
              const [year, month, day] = course.day.split('/');
              start = new Date(parseInt(year), parseInt(month)-1, parseInt(day));
            } else {
              const dayMap = { 'é€±ä¸€':1, 'é€±äºŒ':2, 'é€±ä¸‰':3, 'é€±å››':4, 'é€±äº”':5 };
              const targetDow = dayMap[course.day];
              if(targetDow!=null){
                const delta = (targetDow - (start.getDay()||7) + 7) % 7;
                start.setDate(start.getDate() + delta);
              }
            }
            
            const [hh, mm] = course.time.split('-')[0].split(':');
            if(hh&&mm){ start.setHours(parseInt(hh,10)||9, parseInt(mm,10)||0, 0, 0); }

            const KEY = 'sl_course_bookings';
            let list = [];
            try{ list = JSON.parse(localStorage.getItem(KEY) || '[]'); }catch{ list=[]; }
            
            list.push({
              id,
              courseId: course.id,
              name: course.name,
              category: course.category,
              tags: course.tags,
              type: course.type,
              instructor: course.instructor,
              day: course.day,
              time: course.time,
              site: course.site,
              points: course.points,
              sessions: course.sessions,
              status: isWaitlist ? 'å€™è£œä¸­' : 'å·²é ç´„',
              datetime: start.toISOString(),
              bookingDate: new Date().toISOString(),
              isWaitlist: isWaitlist,
              paymentMethod: isWaitlist ? null : finalPaymentMethod,
              chargeAmount: isWaitlist ? 0 : finalChargeAmount,
              selectedMaterials: selectedMaterials // Save selected materials
            });
            
            localStorage.setItem(KEY, JSON.stringify(list));

            if (isWaitlist) {
              console.log('Showing waitlist popup');
              showPopup(
                'å·²åŠ å…¥å€™è£œ',
                'å·²æˆåŠŸåŠ å…¥å€™è£œåå–®ï¼Œå¦‚æœ‰åé¡é‡‹å‡ºå°‡ä¾æ“šå€™è£œé †åºéè£œã€‚',
                () => { 
                    closeSheet();
                    window.location.href = 'courses.html'; 
                }
              );
            } else {
              let successMsg = '';
              if (finalPaymentMethod === 'charge') {
                successMsg = `æ›å¸³é‡‘é¡ï¼šNT$${finalChargeAmount} å…ƒ\nå°‡åˆ—å…¥æ–¼å®¢æˆ¿å¸³å–®ä¸€èµ·ç¹³è²»ã€‚\n\nè©³æƒ…è«‹æŸ¥çœ‹æˆ‘çš„èª²ç¨‹æ´»å‹•é ç´„ã€‚`;
              } else if (finalPaymentMethod === 'mixed') {
                 successMsg = `å·²æ‰£é™¤ç¾æœ‰é»æ•¸ï¼Œä¸¦æ›å¸³ NT$${finalChargeAmount} å…ƒã€‚\nè©³æƒ…è«‹æŸ¥çœ‹æˆ‘çš„èª²ç¨‹æ´»å‹•é ç´„ã€‚`;
              } else {
                successMsg = `å·²æ‰£é™¤ ${pointsNeeded} é»æ•¸ï¼Œè©³æƒ…è«‹æŸ¥çœ‹æˆ‘çš„èª²ç¨‹æ´»å‹•é ç´„ã€‚`;
              }
              
              showPopup(
                'é ç´„æˆåŠŸ',
                successMsg,
                () => {
                    closeSheet();
                    window.location.href = 'courses.html';
                }
              );
            }
        };

        if (!isWaitlist) {
            if (paymentMethod === 'points') {
                 const userPoints = getUserPoints();
                 if (userPoints < pointsNeeded) {
                     const fullChargeAmount = (pointsNeeded * 10) + totalMaterialFee;
                     const msg = `é»æ•¸ä¸è¶³ï¼éœ€è¦ ${pointsNeeded} é»ï¼Œæ‚¨ç›®å‰æœ‰ ${userPoints} é»ã€‚\nä¾è¦å®šç„¡æ³•ä½¿ç”¨éƒ¨åˆ†é»æ•¸æŠ˜æŠµï¼Œéœ€å…¨é¡ä»¥æ›å¸³æ–¹å¼æ”¯ä»˜ã€‚${totalMaterialFee > 0 ? '\n(å«èª²ç¨‹ææ–™è²» NT$' + totalMaterialFee + ')' : ''}\n\nç¸½æ›å¸³é‡‘é¡ï¼šNT$${fullChargeAmount} å…ƒ\næ˜¯å¦ç¢ºèªé ç´„ï¼Ÿ`;

                     showPopup(
                        'é»æ•¸ä¸è¶³', 
                        msg, 
                        () => { 
                             // ä¸æ‰£é™¤é»æ•¸ï¼Œå…¨é¡æ›å¸³
                             addChargeAmount(fullChargeAmount);
                             executeBooking('charge', fullChargeAmount);
                        }, 
                        () => { /* Cancel */ }, 
                        true // showCancel
                     );
                     return;
                 }
                 deductPoints(pointsNeeded);
                 
                 if (totalMaterialFee > 0) {
                     addChargeAmount(totalMaterialFee);
                     executeBooking('mixed', totalMaterialFee);
                 } else {
                     executeBooking('points', 0);
                 }
            } else if (paymentMethod === 'bill') {
                 chargeAmount = (pointsNeeded * 10) + totalMaterialFee;
                 addChargeAmount(chargeAmount);
                 executeBooking('charge', chargeAmount);
            }
        } else {
            console.log('Processing waitlist...');
            // å€™è£œä¹Ÿè¦æª¢æŸ¥é»æ•¸
            const userPoints = getUserPoints();
            console.log('User points:', userPoints, 'Needed:', pointsNeeded);
            
            if (userPoints < pointsNeeded) {
                 showPopup(
                    'é»æ•¸ä¸è¶³', 
                    `æ‚¨çš„é»æ•¸ (${userPoints} é») ä¸è¶³æ”¯ä»˜æ­¤èª²ç¨‹ (${pointsNeeded} é»)ï¼Œç„¡æ³•åŠ å…¥å€™è£œã€‚`, 
                    () => { 
                         // Do nothing
                    }
                 );
                 return;
            }
            executeBooking(null, 0);
        }
      });

      filter();
    });
  </script>
</head>
<body>
  <!-- Status Bar -->
  <div class="status-bar">
    <span class="time">15:10</span>
    <div class="signal-battery">
      <span class="signal">
        <i class="fas fa-signal"></i>
        <span class="network">5G</span>
      </span>
      <i class="fas fa-battery-three-quarters"></i>
    </div>
  </div>

  <!-- App Header -->
  <header class="app-header">
    <div class="header-left">
      <div class="app-logo">
        <a href="courses.html" aria-label="è¿”å›èª²ç¨‹" class="back-link"><i class="fas fa-chevron-left"></i></a>
        <span class="app-name">èª²ç¨‹æ´»å‹•é ç´„</span>
      </div>
    </div>
    <div class="header-right">
      <button class="close-btn">Ã—</button>
    </div>
  </header>

  <main class="pages-content">
    <!-- Filter Toolbar -->
    <div style="display:flex; justify-content:space-between; align-items:center; padding: 0 4px; margin-bottom:16px;">
        <div style="font-size: 18px; font-weight: 600; color: #000;">èª²ç¨‹èˆ‡æ´»å‹•æ—¥æœŸ</div>
        <button id="openFilterBtn" class="btn-ghost">
           <img src="./images/fa-filter.svg"> 
           é¡å‹ç¯©é¸ <span id="filterCount" style="display:none; background:#ef4444; color:white; border-radius:99px; padding:3px 6px; font-size:12px; min-width: 18px; text-align: center;position: relative;top:-2px;">0</span>
        </button>
    </div>

    <!-- Date Filter -->
    <div class="filter-container" id="dayFilterContainer">
      <!-- Generated by JS -->
    </div>

    <div id="courseList" class="course-list"></div>
  </main>
<!--éš±è—å°èˆª
  <nav class="bottom-nav">
    <a class="nav-item" href="index.html">
      <i class="fas fa-home"></i>
      <span>é¦–é </span>
    </a>
    <a class="nav-item" href="space-booking.html">
      <i class="fas fa-concierge-bell"></i>
      <span>æˆ‘è¦é ç´„</span>
    </a>
    <div class="nav-item">
      <i class="fas fa-wallet"></i>
      <span>éŒ¢åŒ…</span>
    </div>
    <a class="nav-item" href="personal.html">
      <i class="fas fa-user"></i>
      <span>å€‹äºº</span>
    </a>
  </nav>-->
  <div class="home-indicator"></div>

  <!-- Booking Modal Sheet -->
  <div class="modal-overlay" id="modal">
    <div class="modal-container">
        <div class="modal-header">
            <h2>èª²ç¨‹æ´»å‹•é ç´„ç¢ºèª</h2>
            <button class="close-btn" id="closeSheet">&times;</button>
        </div>
        
        <div class="course-summary">
            <!-- <img src="" alt="Course Image" class="course-img" id="s-img"> -->
            <div class="course-info">
                <div class="course-title" id="s-name"></div>
                <div class="course-meta"><i class="fas fa-barcode"></i> <span id="s-code"></span></div>
                <div class="course-meta"><i class="far fa-clock"></i> <span id="s-time"></span></div>
                <div class="course-meta"><i class="fas fa-map-marker-alt"></i> <span id="s-site"></span></div>
                <div class="course-meta"><i class="far fa-user"></i> <span id="s-instructor"></span></div>
                <div style="display: flex; align-items: center; gap: 12px; margin-top: 12px;">
                    <div class="course-points" id="s-points" style="margin-top: 0; font-size: 16px;"></div>
                    <a href="course-detail.html" class="view-details-link" style="margin-top: 0; color: #b3a68b;">æŸ¥çœ‹å®Œæ•´æ´»å‹•è©³æƒ… <i class="fas fa-chevron-right"></i></a>
                </div>
            </div>
        </div>

        <div id="payment-section">
            <div class="section-title">é¸æ“‡ä»˜è²»æ–¹å¼</div>
            <div class="option-card selected" onclick="selectOption(this, 'payment')" data-value="points">
                <div class="option-content">
                    <div class="option-icon"><img src="./images/money-icon.png"></div>
                    <div class="option-text">
                        <span class="option-label">ä½¿ç”¨é»æ•¸</span>
                        <span class="option-sub" id="points-sub"></span>
                    </div>
                </div>
                <div class="radio-circle"></div>
            </div>

            <div class="option-card" onclick="selectOption(this, 'payment')" data-value="bill">
                <div class="option-content">
                    <div class="option-icon"><i class="fas fa-file-invoice-dollar"></i></div>
                    <div class="option-text">
                        <span class="option-label">åˆ—å…¥å®¢æˆ¿å¸³å–®æ”¯ä»˜</span>
                        <span class="option-sub" id="bill-sub"></span>
                    </div>
                </div>
                <div class="radio-circle"></div>
            </div>
        </div>

        <div id="material-fee-section" style="display:none; margin-bottom: 24px;">
            <div class="section-title">èª²ç¨‹ææ–™è²» (å¯é¸)</div>
            <div id="material-description" style="margin-bottom: 12px; font-size: 16px; color: #4b5563; line-height: 1.5;"></div>
            <div id="material-items-container">
                <!-- Dynamic items will be injected here -->
            </div>
            <div style="font-size: 16px; color: #47727c; margin-top: 4px; padding-left: 4px;">
                <i class="fas fa-info-circle"></i> æ­¤è²»ç”¨å°‡åˆ—å…¥å®¢æˆ¿å¸³å–®æ”¶å–ï¼Œç„¡æ³•ä½¿ç”¨é»æ•¸æŠ˜æŠµã€‚
            </div>
        </div>

        <div class="agreement-box" style="justify-content: center; text-align: center;">
            <div class="agreement-text" style="color: #47727c; font-size: 16px;">
                ç‚ºäº†è®“æ‚¨æœ‰æ›´å¥½çš„é«”é©—ï¼Œå¦‚æœæ‚¨é»é¸ç¢ºèªé ç´„ï¼Œè¡¨ç¤ºæ‚¨å·²åŒæ„ <a href="course-notice.html" class="agreement-link" style="color: #00b4b4; text-decoration: underline;">èª²ç¨‹æ´»å‹•é ˆçŸ¥èªªæ˜</a>
            </div>
        </div>

        <button class="confirm-btn" id="confirmBooking">ç¢ºèªé ç´„</button>
    </div>
  </div>

  <!-- Filter Modal -->
  <div class="modal-overlay" id="filterModal">
    <div class="modal-container">
        <div class="modal-header">
            <h2>èª²ç¨‹é¡å‹ç¯©é¸</h2>
            <button class="close-btn" id="closeFilterModal">&times;</button>
        </div>
        
        <div style="margin-bottom:24px;">
            <!-- <div style="font-size:14px; color:#666; margin-bottom:12px;">è«‹é¸æ“‡æ‚¨æ„Ÿèˆˆè¶£çš„èª²ç¨‹é¡å‹ (å¯è¤‡é¸)</div> -->
            <div id="filterOptions" style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
                <!-- Generated by JS -->
            </div>
        </div>

        <div style="display:flex; gap:12px;">
            <button class="btn-ghost-2" id="resetFilter" style="flex:1; padding: 12px;">é‡ç½®</button>
            <button class="btn-primary" id="applyFilter" style="flex:1; background:#00b4b4; color:white; border:none; border-radius:8px; padding:12px; font-weight:600;">ç¢ºèªç¯©é¸</button>
        </div>
    </div>
  </div>

  <!-- Custom Message Popup -->
  <div class="popup-overlay" id="messagePopup">
    <div class="popup-container">
      <div class="popup-icon" id="popupIcon"></div>
      <h3 class="popup-title" id="popupTitle"></h3>
      <p class="popup-message" id="popupMessage"></p>
      <div class="popup-actions">
        <button class="btn-cancel" id="popupCancel" style="display: none;">å–æ¶ˆ</button>
        <button class="btn-confirm" id="popupConfirm">ç¢ºèª</button>
      </div>
    </div>
  </div>
</body>
</html>
